<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <!-- <script src="https://g.alicdn.com/dingding/dingtalk-jsapi/2.10.3/dingtalk.open.js"></script>
JSAPI鉴权 -->
</head>

<body>
  dingding 77888!!!
</body>
<script>
  var _app_agent = {
    trident: navigator.userAgent.indexOf('Trident') > -1, // IE内核
    presto: navigator.userAgent.indexOf('Presto') > -1, // opera内核
    webKit: navigator.userAgent.indexOf('AppleWebKit') > -1, // 苹果、谷歌内核
    gecko: navigator.userAgent.indexOf('Gecko') > -1 && navigator.userAgent.indexOf('KHTML') === -1, // 火狐内核
    mobile: !!navigator.userAgent.match(/AppleWebKit.*Mobile.*/), // 是否为移动终端
    ios: !!navigator.userAgent.match(/Mac OS X/), // ios终端
    android: navigator.userAgent.indexOf('Android') > -1 || navigator.userAgent.indexOf('Linux') > -1, // android终端或者uc浏览器
    iPhone: navigator.userAgent.indexOf('iPhone') > -1, // 是否为iPhone或者QQHD浏览器
    iPad: navigator.userAgent.indexOf('iPad') > -1, // 是否iPad
    weixin: navigator.userAgent.indexOf('MicroMessenger') > -1, // 是否微信
    ali: navigator.userAgent.indexOf('AlipayClient') > -1, // 是否支付宝
    qq: navigator.userAgent.match(/\sQQ/i) === ' qq', // 是否QQ
    ding: navigator.userAgent.indexOf('DingTalk') > -1, // 是否钉钉
    wxwork: navigator.userAgent.indexOf('wxwork') > -1, // 是否企业微信
  };

  // if (_app_agent.ding) {
  //   alert("钉钉环境")
  // }

  // 带corpId， 从首页进入APP
  const script = document.createElement('script');
  script.src = 'https://g.alicdn.com/dingding/dingtalk-jsapi/2.11.2/dingtalk.open.js';

  document.body.appendChild(script);

  script.onload = () => {
    dd = window.dd;
    dd.ready(function () {

      dd.device.notification.vibrate({
	duration: 300,
	onSuccess : function(res) {
		// 调用成功时回调
		console.log(res)
	},
	onFail : function(err) {
		// 调用失败时回调
		console.log(err)
	}
});

  //     fetch('https://oapi.dingtalk.com/gettoken?appkey=dingxf4nwp6rpiyt5ydc&AppSecret=ELAFsss9aFC3klkbBm04_gTZ3pheTVKyZh3VwwSIp0nEsIZUymW9s6x-sqOuau0g')
  // .then(response => {alert(1111);alert(response.json()); return response.json()})
  // .then(data =>data);

    // const res =   async function postData(url = '', data = {}) {
    //     const response = await fetch(url, {
    //       method: 'GET', // *GET, POST, PUT, DELETE, etc.
    //       headers: {
    //         'Content-Type': 'application/json'
    //       },
    //       body: JSON.stringify(data) // body data type must match "Content-Type" header
    //     });
    //     return response.json(); // parses JSON response into native JavaScript objects
    //   }
    // console.log(res)
      // // dd.ready参数为回调函数，在环境准备就绪时触发，jsapi的调用需要保证在该回调函数触发后调用，否则无效。
      // dd.runtime.permission.requestAuthCode({
      //     corpId: "corpid",
      //     onSuccess: function(result) {
      //     /*{
      //         code: 'hYLK98jkf0m' //string authCode
      //     }*/
      //     },
      //     onFail : function(err) {}

      // });
    });
  };
</script>

</html>
